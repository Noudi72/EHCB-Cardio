<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>HIIT Cardio Intervall</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap');
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
      background: #000000;
      font-family: 'Roboto', Arial, sans-serif;
      color: #fff;
      min-height: 100vh;
    }
    .container {
      max-width: 420px;
      margin: 0 auto;
      padding: 16px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .logo {
      width: 120px;
      margin: 12px 0 16px 0;
      user-select: none;
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
    }
    .back-link {
      display: inline-block;
      margin-bottom: 16px;
      color: #ff0000;
      font-size: 1.1rem;
      text-decoration: none;
      font-weight: 600;
      background: none;
      border: none;
      cursor: pointer;
      border-radius: 8px;
      padding: 6px 14px;
      transition: background 0.17s;
      font-family: 'Roboto', Arial, sans-serif;
    }
    .back-link:active {
      background: rgba(255, 0, 0, 0.2);
    }
    .phaseBox {
      background: #FFD600;
      border-radius: 28px;
      box-shadow: 0 3px 20px rgba(255, 214, 0, 0.6);
      width: 100%;
      margin: 24px 0 20px 0;
      padding: 28px 26px 26px 26px;
      display: flex;
      flex-direction: column;
      align-items: center;
      transition: box-shadow 0.25s;
      color: #000;
      text-shadow: none;
    }
    .phaseLabel {
      font-size: 2.1rem;
      font-weight: 700;
      margin-bottom: 8px;
      letter-spacing: 0.03em;
    }
    #phaseDesc {
      font-size: 1.25rem;
      color: #222;
      margin-bottom: 10px;
      text-align: center;
      min-height: 26px;
    }
    #timer {
      font-size: 4.8rem;
      font-weight: 700;
      margin: 12px 0 12px 0;
      letter-spacing: 0.03em;
      color: #000;
      text-shadow: 0 3px 12px rgba(0,0,0,0.15);
    }
    #phaseInfo {
      font-size: 1.18rem;
      margin-bottom: 6px;
      color: #333;
      text-align: center;
    }
    #phaseCount {
      font-size: 1.15rem;
      color: #333;
      margin-bottom: 0;
    }
    .btn-row {
      display: flex;
      gap: 14px;
      margin: 22px 0 14px 0;
      flex-wrap: wrap;
      justify-content: center;
    }
    .btn {
      font-family: 'Roboto', Arial, sans-serif;
      font-size: 1.15rem;
      padding: 11px 26px;
      border-radius: 14px;
      border: none;
      background: #ff0000;
      color: #fff;
      font-weight: 700;
      box-shadow: 0 2px 10px rgba(255,0,0,0.3);
      cursor: pointer;
      transition: background 0.22s;
      user-select: none;
    }
    .btn:active {
      background: #b30000;
    }
    .btn.secondary {
      background: #222222;
      color: #ff0000;
      border: 1.5px solid #ff0000;
      box-shadow: none;
    }
    .btn.secondary:active {
      background: #440000;
    }
    .edit-table-container {
      width: 100%;
      margin-bottom: 22px;
      overflow-x: auto;
      border-radius: 16px;
      background: #111111;
      box-shadow: 0 3px 12px rgba(255,0,0,0.15);
      padding: 16px 12px 10px 12px;
      color: #fff;
      font-family: 'Roboto', Arial, sans-serif;
    }
    table {
      border-collapse: collapse;
      width: 100%;
      min-width: 340px;
      font-size: 1.05rem;
      color: #fff;
    }
    th, td {
      text-align: left;
      padding: 10px 12px;
      border-bottom: 1px solid #330000;
    }
    th {
      background: #330000;
      font-weight: 700;
      color: #ff0000;
      font-size: 1.07rem;
      border-bottom: 2px solid #660000;
    }
    tr:last-child td {
      border-bottom: none;
    }
    td input, td select {
      font-size: 1.05rem;
      border-radius: 8px;
      border: 1.5px solid #660000;
      padding: 6px 8px;
      width: 95%;
      font-family: 'Roboto', Arial, sans-serif;
      background: #220000;
      color: #fff;
      transition: border-color 0.2s;
    }
    td input:focus, td select:focus {
      border-color: #ff0000;
      outline: none;
      background: #330000;
    }
    .table-btn {
      background: none;
      border: none;
      color: #ff0000;
      font-size: 1.3rem;
      cursor: pointer;
      margin: 0 4px;
      padding: 0 6px;
      transition: color 0.3s;
      user-select: none;
    }
    .table-btn:active {
      color: #b30000;
    }
    @media (max-width: 570px) {
      .container {
        padding: 8px;
      }
      .logo {
        width: 100px;
        margin: 10px 0 14px 0;
      }
      .back-link {
        font-size: 1rem;
        padding: 5px 12px;
        margin-bottom: 12px;
      }
      .phaseBox {
        padding: 22px 18px 20px 18px;
        border-radius: 22px;
      }
      .phaseLabel {
        font-size: 1.7rem;
      }
      #phaseDesc {
        font-size: 1.05rem;
        margin-bottom: 8px;
        min-height: 20px;
      }
      #timer {
        font-size: 3.6rem;
        margin: 10px 0 10px 0;
      }
      #phaseInfo {
        font-size: 1rem;
        margin-bottom: 4px;
      }
      #phaseCount {
        font-size: 1rem;
      }
      .btn {
        font-size: 1rem;
        padding: 9px 20px;
        border-radius: 12px;
      }
      .btn-row {
        gap: 10px;
        margin: 18px 0 12px 0;
      }
      .edit-table-container {
        padding: 12px 8px 8px 8px;
        font-size: 0.95rem;
      }
      table {
        font-size: 0.95rem;
        min-width: 260px;
      }
      th, td {
        padding: 8px 10px;
      }
      td input, td select {
        font-size: 0.95rem;
        padding: 5px 7px;
      }
      .table-btn {
        font-size: 1.15rem;
        margin: 0 2px;
        padding: 0 4px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <button class="back-link" onclick="window.location.href='index.html'">&larr; Zurück</button>
    <img src="EHCB_logo.png" alt="EHCB Logo" class="logo" draggable="false" />
    <div class="phaseBox">
      <div class="phaseLabel" id="phaseLabel">Get Ready</div>
      <div id="phaseDesc"></div>
      <div id="timer">00:30</div>
      <div id="phaseInfo"></div>
      <div id="phaseCount"></div>
    </div>
    <div class="btn-row">
      <button class="btn" id="startBtn">Start</button>
      <button class="btn secondary" id="editBtn">Bearbeiten</button>
      <button class="btn secondary" id="resetBtn">Reset</button>
    </div>
    <div class="edit-table-container" id="editTableContainer" style="display:none;">
      <table id="phaseTable">
        <thead>
          <tr>
            <th>Phase</th>
            <th>Dauer (Sek.)</th>
            <th>Beschreibung</th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          <!-- Zeilen werden dynamisch hinzugefügt -->
        </tbody>
      </table>
      <button class="btn" style="margin-top:12px;" onclick="addPhase()">+ Phase</button>
    </div>
  </div>
  <audio id="audioBeep" src="beep.mp3" preload="auto"></audio>
  <audio id="audioStart" src="start.mp3" preload="auto"></audio>
  <audio id="audioEnd" src="end.mp3" preload="auto"></audio>
  <script>
    // HIIT-Phasen (Get Ready 30 Sek. + 10x [Work 30s, Rest 15s] + Cool Down 60s)
    const defaultPhases = [
      { label: "Get Ready", duration: 30, desc: "" },
      { label: "Work", duration: 30, desc: "Volle Power!" },
      { label: "Rest", duration: 15, desc: "Erholung" },
      { label: "Work", duration: 30, desc: "Volle Power!" },
      { label: "Rest", duration: 15, desc: "Erholung" },
      { label: "Work", duration: 30, desc: "Volle Power!" },
      { label: "Rest", duration: 15, desc: "Erholung" },
      { label: "Work", duration: 30, desc: "Volle Power!" },
      { label: "Rest", duration: 15, desc: "Erholung" },
      { label: "Work", duration: 30, desc: "Volle Power!" },
      { label: "Rest", duration: 15, desc: "Erholung" },
      { label: "Work", duration: 30, desc: "Volle Power!" },
      { label: "Rest", duration: 15, desc: "Erholung" },
      { label: "Work", duration: 30, desc: "Volle Power!" },
      { label: "Rest", duration: 15, desc: "Erholung" },
      { label: "Work", duration: 30, desc: "Volle Power!" },
      { label: "Rest", duration: 15, desc: "Erholung" },
      { label: "Work", duration: 30, desc: "Volle Power!" },
      { label: "Rest", duration: 15, desc: "Erholung" },
      { label: "Work", duration: 30, desc: "Volle Power!" },
      { label: "Cool Down", duration: 60, desc: "Abkühlen" }
    ];
    let phases = JSON.parse(JSON.stringify(defaultPhases));
    let currentPhase = 0;
    let currentTime = phases[0].duration;
    let timer = null;
    let running = false;
    let editMode = false;
    const timerEl = document.getElementById('timer');
    const phaseLabelEl = document.getElementById('phaseLabel');
    const phaseDescEl = document.getElementById('phaseDesc');
    const phaseInfoEl = document.getElementById('phaseInfo');
    const phaseCountEl = document.getElementById('phaseCount');
    const startBtn = document.getElementById('startBtn');
    const editBtn = document.getElementById('editBtn');
    const resetBtn = document.getElementById('resetBtn');
    const editTableContainer = document.getElementById('editTableContainer');
    const phaseTable = document.getElementById('phaseTable').getElementsByTagName('tbody')[0];
    function pad(n) { return n < 10 ? '0'+n : n; }
    function renderPhase() {
      const p = phases[currentPhase];
      phaseLabelEl.textContent = p.label;
      phaseDescEl.textContent = p.desc || '';
      timerEl.textContent = pad(Math.floor(currentTime/60)) + ':' + pad(currentTime%60);
      if(currentPhase === 0) {
        phaseInfoEl.textContent = "Bereite dich vor";
        phaseCountEl.textContent = "";
      } else {
        let cycle = Math.floor((currentPhase-1)/2)+1;
        let totalCycles = Math.floor((phases.length-2)/2);
        if(p.label === "Work") {
          phaseInfoEl.textContent = "Intensive Belastung";
          phaseCountEl.textContent = `Intervall ${cycle} / ${totalCycles}`;
        } else if(p.label === "Rest") {
          phaseInfoEl.textContent = "Kurze Pause";
          phaseCountEl.textContent = `Intervall ${cycle} / ${totalCycles}`;
        } else if(p.label === "Cool Down") {
          phaseInfoEl.textContent = "Abkühlen";
          phaseCountEl.textContent = "";
        } else {
          phaseInfoEl.textContent = "";
          phaseCountEl.textContent = "";
        }
      }
    }
    function playBeep() {
      document.getElementById('audioBeep').play();
    }
    function playStart() {
      document.getElementById('audioStart').play();
    }
    function playEnd() {
      document.getElementById('audioEnd').play();
    }
    function nextPhase() {
      currentPhase++;
      if(currentPhase >= phases.length) {
        stopTimer();
        timerEl.textContent = "Fertig!";
        phaseLabelEl.textContent = "Workout beendet";
        phaseDescEl.textContent = "";
        phaseInfoEl.textContent = "";
        phaseCountEl.textContent = "";
        playEnd();
        return;
      }
      currentTime = phases[currentPhase].duration;
      // Startschuss NUR nach Get Ready
      if(currentPhase === 1) playStart();
      renderPhase();
    }
    function tick() {
      if(currentTime > 0) {
        if(currentTime <= 4 && currentTime > 1) playBeep();
        currentTime--;
        renderPhase();
      } else {
        nextPhase();
      }
    }
    function startTimer() {
      if(running) return;
      running = true;
      startBtn.disabled = true;
      editBtn.disabled = true;
      timer = setInterval(tick, 1000);
    }
    function stopTimer() {
      running = false;
      startBtn.disabled = false;
      editBtn.disabled = false;
      clearInterval(timer);
    }
    function resetAll() {
      stopTimer();
      currentPhase = 0;
      currentTime = phases[0].duration;
      renderPhase();
    }
    startBtn.onclick = startTimer;
    resetBtn.onclick = resetAll;
    editBtn.onclick = function() {
      editMode = !editMode;
      editTableContainer.style.display = editMode ? 'block' : 'none';
      if(editMode) {
        renderEditTable();
        startBtn.disabled = true;
        resetBtn.disabled = true;
      } else {
        startBtn.disabled = false;
        resetBtn.disabled = false;
      }
    };
    function renderEditTable() {
      phaseTable.innerHTML = '';
      for(let i=0; i<phases.length; i++) {
        let row = document.createElement('tr');
        // Phase
        let td1 = document.createElement('td');
        let inpLabel = document.createElement('input');
        inpLabel.type = 'text';
        inpLabel.value = phases[i].label;
        inpLabel.onchange = e => { phases[i].label = e.target.value; renderPhase(); };
        td1.appendChild(inpLabel);
        // Dauer
        let td2 = document.createElement('td');
        let inpDur = document.createElement('input');
        inpDur.type = 'number';
        inpDur.min = 1;
        inpDur.value = phases[i].duration;
        inpDur.onchange = e => { phases[i].duration = Math.max(1, parseInt(e.target.value)||1); renderPhase(); };
        td2.appendChild(inpDur);
        // Beschreibung
        let td3 = document.createElement('td');
        let inpDesc = document.createElement('input');
        inpDesc.type = 'text';
        inpDesc.value = phases[i].desc||'';
        inpDesc.onchange = e => { phases[i].desc = e.target.value; renderPhase(); };
        td3.appendChild(inpDesc);
        // Buttons
        let td4 = document.createElement('td');
        if(i>0) {
          let btnDel = document.createElement('button');
          btnDel.className = 'table-btn';
          btnDel.innerHTML = '🗑️';
          btnDel.title = "Phase löschen";
          btnDel.onclick = () => { phases.splice(i,1); renderEditTable(); resetAll(); };
          td4.appendChild(btnDel);
        }
        row.appendChild(td1);
        row.appendChild(td2);
        row.appendChild(td3);
        row.appendChild(td4);
        phaseTable.appendChild(row);
      }
    }
    function addPhase() {
      phases.push({ label: "Work", duration: 30, desc: "" });
      renderEditTable();
    }
    // Initial Render
    renderPhase();
  </script>
</body>
</html>